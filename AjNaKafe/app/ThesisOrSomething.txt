Универзитет Св.Кирил и Методиј – Скопје

Факултет за информатички науки и
компјутерско инженерство





Дипломски труд
Развој на веб апликација за пронаоѓање нови пријателства – АјНаКафе





Ментор:                                            Изработил:
Професор д-р Весна Димитриевска Ристовска          Марко Лазаревски






Скопје, 2025


Апстракт
Дигиталното запознавање во Македонија се соочува со неколку карактеристични проблеми: глобалните платформи не го земаат предвид локалниот контекст, нема лесен начин да се вкрстат интереси и локација на корисници, а безбедната комуникација најчесто се изместува на нерегулирани канали. „АјНаКафе“ претставува модерен веб-систем за поврзување луѓе околу заедничкиот мотив – дружењето на кафе. Апликацијата комбинира Laravel 9 back-end (REST API, Sanctum автентикација, доменски модели за корисници, симпатии, совпаѓања и разговори) и React 18 front-end (swipe искуство, табови за совпаѓања/пораки, wizard за регистрација, уредување профил со интерактивна мапа). Реално-времените известувања преку Laravel WebSockets, Echo и Pusher овозможуваат системски пораки, match-нотификации и чат без освежување на страницата. Дополнително, job-от „FindCafeForMatch“ повикува Overpass API за да предложи кафич блиску до двата корисници, создавајќи контекстуализирана стартна точка за средба. Трудот ја опишува архитектурата, доменските модели, функционалните и нефункционалните барања, имплементациските детали и сценаријата на користење, покажувајќи дека комбинацијата од Laravel, React и современ UI може да произведе сигурна, локализирана платформа за нови познанства.



1. Вовед
1.1 Мотивација
//Современите урбани средини овозможуваат богата социјална динамика, но бараат дигитални алатки што ги почитуваат навиките на младите луѓе. Во Македонија, „ај на кафе" е многу популарен културен мотив – кафулињата се полни, а кафето е централна точка за социјализација. Мотивацијата зад „АјНаКафе" произлегува од потребата да се комбинира овој локален идентитет, реално-времени технологии и естетско искуство налик на мобилни апликации во веб форма достапна од десктоп и мобилни уреди.

1.2 Опис и дефиниција на проблемот
Иако постојат глобални апликации како „Tinder“, македонските корисници често доживуваат бариери: интерфејсот и содржината не се локализирани, премиум модели (Plus/Gold/Super Likes) го ограничуваат органското користење, а препораките не ги земаат предвид локалните навики (на пр. културата на „ај на кафе“). Дополнително, многу корисници сакаат да се запознаат во контролирана, бесплатна средина каде што секој профил може да внесе повеќе фотографии, точна геолокација и биографија на македонски јазик. Постои и недостаток на алатки што помагаат при избор на реална локација за средба и што нудат transparentен систем за комуникација без дополнителни плаќања. Без домашна, бесплатно достапна платформа, запознавањето се префрла во ад-хок Viber/Instagram групи каде што нема проверка, нема препораки според растојание и нема поттик за градење доверба. „АјНаКафе“ го адресира овој вакуум со локално дизајнирано искуство, интегрирани мапи, real-time chat и систем за предлози на кафулиња – сè достапно бесплатно за корисниците од Македонија.

1.3 Цели на проектот
Главните цели се: да се изгради монолитен Laravel API со јасни доменски модели; да се обезбеди React апликација со интерактивно swipe искуство и табови за управување со совпаѓања и разговори; да се имплементира гео-интелигентно совпаѓање со асинхрони предлози за кафулиња; да се интегрира WebSocket инфраструктура за нотификации и chat; да се создаде администраторски интерфејс за управување со корисници и валидација на содржина. Дополнително, постојат бизнис цели: да се изгради доверба кај локалната заедница за да се постигне критична маса на корисници, да се подготви модел за монетизација (премиум претплати, „super like“, приоритетни match-ови или промотивни кафулиња), како и аналитички модул кој ќе следи KPI (регистрации, активација, задржување) и ќе информира идни маркетинг кампањи. Социјалната цел е да се поттикне безбедна комуникација и култура на одговорно запознавање, додека техничката цел е платформата да биде доволно модуларна за идни проширувања со мобилни клиенти и интеграција со локални бизниси (кофе барови, настани, loyalty програми).


2. Истражувачки пристап
Истражувањето започна со анализа на глобални решенија (Tinder, Bumble, Hinge) и нивните ограничувања за македонскиот пазар: не-локализиран UI/јазик, зависност од платени пакети и отсуство на културни мотиви (на пр. покана „ај на кафе"). Беа прегледани App Store и Google Play рецензии за модерни dating апликации за да се идентификуваат чести забелешки од корисниците: скапи супер-лајкови, нерелевантни препораки, недостиг од локални настани и фрустрација од paywall моделите. Дополнително беа анализирани кориснички сведоштва и блогови каде корисници опишуваат дека платените претплати (на пр. Tinder Gold за $18 неделно) создаваат „златен ѕид" кој ги прикрива match-овите додека не се плати, што резултира со чувство на „downgraded верзија" на апликацијата за бесплатни корисници и фрустрација дека квалитетните профили се резервирани само за платени членови. Вториот чекор опфати анализа на регионални медиуми и Google Trends за да се разбере сезоналноста на поимите „запознавање", „кафе запознавање" и интересот за бесплатни алтернативи во Македонија. Финално, беа спроведени неформални разговори со локални кафе-барови за да се валидира потребата од дигитални партнерства и попусти како дел од платформата. Овие увидувања ја дефинираа потребата „АјНаКафе" да биде бесплатна, локализирана и да интегрира предлози за реални локации.
3. Методологија на развој
- Минималниот производ опфати регистрација, swipe, match и chat.
- Потоа следеше брз UI прототип и избор на технолошкиот стек (Laravel + React).
- Имплементацијата се организираше по модули со неделни итерации.
- Секој циклус завршуваше со тестирање преку Postman и рачни сценарија.
- Повратните информации резултираа со корекции во UI-то, нотификациите и chat-логиката.
Податоците се чуваат во MySQL, а sqlite се користеше за локални итерации.

3. Технологии за развој на веб апликацијата
3.1 Back-end технологија: Laravel 9
Laravel 9 обезбедува структуриран MVC пристап, Eloquent ORM и готови механизми за токенска автентикација преку Sanctum. Во „АјНаКафе“ се користат моделите `User`, `Like`, `Matches`, `Chat` и `Message`, REST контролерите (`AuthController`, `UserController`, `LikeController`, `MessageController`) и job `FindCafeForMatch`, кој асинхроно го повикува Overpass API за да предложи заеднички кафич. Middleware-от `auth:sanctum` обезбедува заштитен пристап до приватните рути, а broadcasting конфигурацијата (BroadcastServiceProvider + канал `App.Models.User.{id}`) заедно со нотификациите `MatchFound` и `NewChatMessage` (кои имплементираат `ShouldBroadcast`) обезбедуваат испорака на настани до Echo клиентот веднаш по креирање match или порака.

3.2 Front-end технологија и UI дизајн
React 18 со Vite овозможува брзо развивање на component-based интерфејси. Axios client врши повици кон API, а Context Provider управува со `user`, `token` и глобални нотификации. UI-то комбинира Material UI, MDBootstrap, React Chat Elements и custom CSS (градиенти, glassmorphism, анимации). Дизајнот е mobile-first: `SwipeCards` користи `react-tinder-card` за полноекрански картички со карусел од фотографии, краток био и ознаки за род/преференца; при mutual like се појавува `MatchDialog` со CTA за чат и кратки совети. `Tabs` компонентата е адаптивна – на desktop е хоризонтална со броачи за unread пораки, а на мобилен се трансформира во дното како навигација. Sidebar-от прикажува мини-профил и филтер за растојание, додека `UserDetails` вклучува wizard со интерактивна мапа и preview на слики. Чатот има bubble изглед, поддршка за прикачување слики и системски пораки со визуелно издвоена лента. Сите текстови се на македонски и имаат кафе-колор палета (кафеави, крем и пастелно розови нијанси) за одржување на темата „АјНаКафе“.

3.3 Податочен слој и складирање
MySQL е примарната база на податоци и е обликувана преку неколку миграции. Основната `users` табела содржи `name`, `email`, `password` и токен за remember me, а последователните миграции додаваат домен-специфични полиња: `gender`, уникатен `telephone`, `location` (чува lat,lng во текст формат), `date` (датум на раѓање), `preference` (кого бара корисникот) и патека до `profile_picture`. `user_pictures` е `text` што складира повеќе патеки раздвоени со `:` за лесно проширување кон посебна табела, а `bio` е `text` поле за опис. Сите овие полиња се пополнуваат преку онбординг wizard-от и се валидаираат на backend.
Табелата `likes` има `from_user_id`, `to_user_id` и `status` (`like`/`dislike`) со `onDelete('cascade')`, па кога се брише профил исчезнуваат и неговите реакции. `matches` парот `user1_id`/`user2_id` и статус (`active`, `rejected`, `unmatched`) се користи за да се следи текот на релацијата; `match_date` бележи кога настанал взаимниот like. Откако ќе се формира match се креира запис во `chats` со истите два корисника.
`messages` се врзани за `chat_id` и `user_id`. Секој ред чува `content`, флаг `is_file` (дали содржината покажува на прикачен фајл) и `sent_at`. Дополнителната миграција `add_is_system_to_messages` додава `is_system` за системските пораки (на пример предлог за кафич). Прикачените фајлови се складираат на диск, а во базата се чува патеката.
За broadcasting се користи стандардната `notifications` табела (UUID примарен клуч, `type`, `data`, `read_at`). Laravel автоматски ги пополнува овие записи кога се испраќаат `MatchFound` и `NewChatMessage`, што дозволува да се следи дали корисникот ја прочитал нотификацијата. Дополнително, се присутни и системските табли (`failed_jobs`, `jobs`, `websockets_statistics_entries`) за редицата и WebSocket telemetry, како и `password_resets` за стандарден Laravel flow.

3.4 Реално-времени комуникации
Платформата користи Laravel WebSockets (BeyondCode) и Pusher-compatible Echo клиент (`react/src/services/echo.js`). Нотификациите `MatchFound` и `NewChatMessage` имплементираат `ShouldBroadcast` и емитуваат во приватниот канал `App.Models.User.{id}`. WebSocket серверот работи на порт 6001 со self-hosted pusher driver, така што не се користи Redis – Laravel ја испорачува пораката директно до WebSocket серверот, а Echo ја прима без reload.

3.5 Поддржувачки библиотеки и интеграции
Leaflet и Nominatim овозможуваат избор и превод на координати во адреса во профилот. React DatePicker обезбедува UX за датуми, `react-tinder-card` ја носи swipe механиката, `CarouselSlider` (базиран на `react-responsive-carousel`) прикажува повеќе фотографии, а `react-chat-elements` ја визуелизира chat историјата со bubbles, attachments и typing indicator. Hearts loader служи за визуелизација на вчитување, додека Laravel HTTP клиент со retry логика комуницира со Overpass API.

3.6 Архитектура
Се користи слоевита clean/onion архитектура во рамки на монолит. Внатрешниот „доменски“ слој ги опфаќа моделите и бизнис правилата (`User`, `Like`, `Matches`, `Chat`, `Message`, match логика, Haversine пресметки, job-от `FindCafeForMatch`). Application слојот е составен од REST контролери, request класи и нотификации/настани кои ги оркестрираат use-case сценаријата (signup, swipe, chat). Инфраструктурниот слој ги вклучува Sanctum, Laravel WebSockets, Storage, queue driver и интеграцијата со Overpass API. React SPA е изолиран клиенски слој што разговара со application слојот преку JSON API, па секој слој има јасно boundary и може да се тестира/подмени без да се наруши целината.

4. Функционални барања
4.1 Корисничка апликација
- Регистрација во два чекори со мапа, избор на род и преференца, телефон и профилна фотографија.
- Преглед и уредување на сопствен профил (биографија, повеќе слики, локација, контакт).
- Swipe интерфејс со филтри по растојание и род, like/dislike акција и приказ на 10 кандидати.
- Табови за совпаѓања и пораки со навигација кон чат интерфејс.
- Чат со текст, слики и системски пораки, плус моментални нотификации за нови пораки.

4.2 Бизнис апликација
- Административна табела за преглед и уредување на корисници (`/users`).
- Можност за бришење профили и управување со несоодветна содржина.
- Логови и снимени Overpass одговори за ревизија на job-от за кафулиња.

4.3 Нефункционални барања
- Безбедност: HTTPS, токенска автентикација, серверска валидација на upload (10MB), CSRF за web рути.
- Перформанси: цел е да се одржува брз одговор на API повиците и ниска латентност на WebSocket-ите; тековно перформансите се следат преку developer tools и логови, а формални load тестови се планирани за наредните итерации.
- Скалибилност: независно хостирање на front-end/back-end и queue работници за job-ови.
- Употребливост: сите интерфејси се на македонски јазик, а UI-то е оптимизирано за мобилни резолуции (responsive layout, touch-friendly контроли).


5. Општ преглед
5.1 Архитектонска рамка
Системот се состои од Laravel API (REST + WebSockets), React SPA и MySQL. Автентицирани повици се прават преку Axios со Bearer токен, а real-time каналите користат Echo со ист токен. Статичките фотови и документи се складираат во `storage/app/public` и се сервираат преку `public/storage`.

[Слика 5.1 – Системска архитектура: React SPA, Laravel API, MySQL и Storage со стрелки што покажуваат HTTP REST повици, WebSocket комуникација и пристап до база/складирање]

5.2 Домени модел и DDD
- Доменот има четири агрегати:
  - **Корисник** – профилни информации, локација и галерии (`user_pictures`, `bio`).
  - **Интеракции** – `Like` и `Matches` со состојби `like/dislike/active`, логика за reciprocity и дистанца.
  - **Комуникација** – `Chat` и `Message` со флагови `is_file` и `is_system`.
  - **Известувања** – `MatchFound` и `NewChatMessage` како доменски настани што тригерираат broadcast.
Овој пристап го олеснува мапирањето на реалните процеси во код и остава простор во иднина секој агрегат да стане посебен сервис.

5.3 Релациона база и миграции
[Слика 5.2 – ER дијаграм на базата на податоци: табели users, likes, matches, chats, messages, notifications со foreign keys и релации]

Миграциите креираат и надградуваат неколку табли:
- `users`: основната структура (име, е-пошта, лозинка, `remember_token`) + дополнителни колони преку последователни миграции (`gender`, `telephone`, `location`, `date`, `preference`, `profile_picture`, `user_pictures`, `bio`). `user_pictures` складира повеќе патеки од галерија во `:` формат за лесно подоцнежно издвојување.
- `likes`: чува секоја swipe акција со `from_user_id`, `to_user_id` и `status` (`like`/`dislike`), а `onDelete('cascade')` осигурува автоматско бришење кога некој профил се избрише.
- `matches`: `user1_id`, `user2_id`, `status` (`active`, `rejected`, `unmatched`) и `match_date`. Овој запис е тригер за креирање `chats` и за диспечирање на `FindCafeForMatch`.
- `chats` и `messages`: `messages` има `chat_id`, `user_id`, `content`, флаг `is_file` и проширен `is_system` за автоматските пораки од job-от; `sent_at` се пополнува со тековен timestamp.
- `notifications`: стандардната Laravel таблица со UUID `id`, `type`, `data` и `read_at`, што се користи за `MatchFound` и `NewChatMessage`.
Сите надворешни клучеви имаат `onDelete('cascade')`, што спречува појава на сирочади записи и ја олеснува администраторската модерирација (бришење на профил автоматски ја чисти историјата на лајкови, матчи и пораки).

5.4 API слој
`routes/api.php` ги дефинира ресурсите поделени на јавни (без middleware) и заштитени (зад `auth:sanctum` middleware).

**Јавни endpoints:**
- `POST /signup` (`AuthController::signup`) – регистрација со валидација на `SignupRequest`, зачувување на профилна слика во `storage/profile_pictures`, креирање на корисник и враќање на Sanctum токен.
- `POST /login` (`AuthController::login`) – автентикација преку `LoginRequest`, проверка на credentials и враќање на токен; при неуспех враќа 422 со македонска порака за грешка.

**Заштитени endpoints (зад `auth:sanctum`):**
- `POST /logout` (`AuthController::logout`) – бришење на тековниот токен и одјава.
- `GET /user` – враќа податоци за тековниот автентициран корисник.
- `GET /user/{id}` – враќа детали за корисник по ID (404 ако не постои).
- `GET /users` (`UserController::index`) – пагинирана листа на сите корисници (10 по страница), сортирана по ID во опаѓачки редослед, враќа `UserResource` колекција.
- `POST /users` (`UserController::store`) – креирање на нов корисник од администратор, валидација преку `StoreUserRequest`, хеширање на лозинка.
- `GET /users/{id}` (`UserController::show`) – детали за конкретен корисник преку `UserResource`.
- `PUT /users/{user}` (`UserController::update`) – ажурирање на профил со `UpdateUserRequest`, проверка на авторизација (само сопственик може да ажурира), поддршка за `profile_picture` и повеќе `user_pictures` (складирани како патеки раздвоени со `:`), хеширање на лозинка ако е променета.
- `DELETE /users/{user}` (`UserController::destroy`) – бришење на корисник (204 No Content).
- `POST /like` (`LikeController::likeUser`) – зачувува акција (like/dislike), проверува реципрочен like, креира `Matches` и `Chat` записи, диспечира `FindCafeForMatch` job и испраќа `MatchFound` notifications.
- `GET /swiped-users` (`LikeController::getSwipedUsers`) – ги исклучува веќе обработените профили (лајкани или дизлајкани), применува gender preference филтер и Haversine пресметка по растојание (query параметар `distance`), враќа листа за `SwipeCards` компонентата.
- `GET /matches` (`MatchesController::getMatches`) – враќа сите активни matches за тековниот корисник (каде е `user1_id` или `user2_id`), eager loading на `user1` и `user2` релациите.
- `GET /chats` (`MessageController::getChats`) – листа на сите chats каде корисникот е учесник, со eager loading на `user1`, `user2` и последна порака (преку `withLastMessage` scope).
- `GET /chats/{chatId}` (`MessageController::getChatInfo`) – детали за конкретен chat со проверка на авторизација (корисникот мора да е `user1_id` или `user2_id`), враќа chat со `user1` и `user2` податоци.
- `GET /chats/{chatId}/messages` (`MessageController::getMessages`) – проверува дали тековниот корисник припаѓа на чатот, ги враќа пораките сортирани по `sent_at` (ascending) и додава `file_url`/`is_system` полиња за фронтендот.
- `POST /chats/{chatId}/messages` (`MessageController::send`) – бара или текст или фајл (до 10 MB), го чува фајлот во `storage/messages`, додава `file_url` ако е потребно и преку `NewChatMessage` notification го известува другиот учесник во чатот (Echo го прима во реално време).

5.5 Интеграции со надворешни сервиси
Job-от `FindCafeForMatch` користи Overpass API за да најде кафулиња во радиус од 600m околу средиштето меѓу две координати, потоа создава Google Maps линк. Leaflet/Nominatim обезбедуваат обратен геокодинг во профилот, а WebSockets се хостираат преку `beyondcode/laravel-websockets`.

5.6 Кориснички интерфејс
[Слика 5.3 – Landing страница: hero секција со кафе-тема, CTA копчиња за Login и Signup, responsive дизајн]

1. **Landing / Guest Layout**
   - Содржи CTA за логирање и регистрација, со краток pitch „пронајди пријатели за кафе“. 
   - На десктоп прикажува hero илустрација со кафе-тема, додека на мобилен се сведува на едноставни табови за `Login` и `Signup`.

2. **Signup Wizard**
   - Три чекори: лични податоци + профилна слика, преференци (род/преференца/датум) и локација преку интерактивна мапа (Leaflet + геокодирање).
   - Валидации во реално време за телефон (+389 формат), силни лозинки и preview на сликите/галерија.
   [Слика 5.4 – Signup Wizard чекор 1: форма со полиња за име, е-пошта, лозинка, телефон и preview на профилна слика]
   [Слика 5.5 – Signup Wizard чекор 3: интерактивна мапа (Leaflet) со маркер за локација и обратен геокодинг на адреса]

3. **Login / Forgot Password**
   - Форма со е-пошта/лозинка и опција за „Запомни ме“. 
   - Линк до „Заборавена лозинка“ (подготвено за Password Reset flow) и визуелен индикатор за грешки.

4. **Default Layout Dashboard**
   - Sidebar со мини-профил, индикатор за нотификации и слајдер за растојание (0–100 км) кој влијае на `SwipeCards`.
   - Главен дел со рути: `/cards`, `/tabs`, `/chat/:id`, `/user-details`, `/users`.

5. **Swipe Cards (`/cards`)**
   - Картички со `CarouselSlider` (фотографии), име, години, род, преференца, bio и CTA копчиња (`Like`, `Dislike`).
   - `react-tinder-card` овозможува drag/swipe гестови, а празната состојба прикажува порака ако нема повеќе кандидати во радиусот.
   [Слика 5.6 – Swipe Cards екран: профилна картичка со карусел од фотографии, име, возраст, род, преференца, bio и Like/Dislike копчиња]

6. **Match Dialog**
   - Модален прозорец што се појавува при mutual like: ги покажува двете профилни слики, порака „Се совпаднавте!" и копче „Отвори чат".
   - Анимација (scale-in) и затворање по 5 секунди или при клик.
   [Слика 5.7 – Match Dialog: модален прозорец со две профилни слики, порака за совпаѓање и копче за отворање на чат]

7. **Tabs (`/tabs`)**
   - Две табови: „Совпаѓања“ (листинг со картички + CTA „Започни разговор“) и „Пораки“ (chat листа со preview на последна порака, timestamp и badge за непрочитани).
   - На мобилен, табовите се sticky во долниот дел за брза навигација.

8. **Chat (`/chat/:id`)**
   - Bubble интерфејс со `react-chat-elements`, поддржува текст, слики, прикачени фајлови и системски пораки (кафич препораки).
   - Composer со textarea, upload и копче „Испрати". WebSocket известувања додаваат нови пораки без refresh.
   [Слика 5.8 – Chat екран: bubble интерфејс со текст пораки, прикачена слика, системска порака за кафич со Google Maps линк и composer за нова порака]

9. **User Details (`/user-details`)**
   - Формулар за уредување име, е-пошта, телефон, преференца, датум на раѓање, bio, локација (месечно со drag на мапа) и галерија со повеќе слики (upload, delete, preview).
   - Секцијата „Безбедност" овозможува ресет на лозинка (placeholder за идна функционалност).
   [Слика 5.9 – User Details екран: формулар за уредување профил со интерактивна мапа, галерија со preview на слики и секција за безбедност]

10. **Admin Users (`/users`)**
    - Табела со сите корисници: ID, име, е-пошта, род, статус. Опции за „Edit“, „Delete“, „Impersonate“ (за поддршка).
    - Филтри по статус (active/blocked) и search по е-пошта. Оваа рута е заштитена со policy (само админ).
5.7 Безбедност и автентикација
Laravel Sanctum обезбедува токенска автентикација со минимален overhead. Middleware `auth:sanctum` се применува на сите критични рути. Валидационите класи (`SignupRequest`, `LoginRequest`, `UpdateUserRequest`) спречуваат SQL injection и невалидни фајлови. Upload-ите се складираат во `storage_path('app/public')` и се сервираат преку симболичка врска. Echo испраќа Authorization header со Bearer токен за WebSocket автентикација.


6. Имплементација
6.1 Регистрација и онбординг
Процесот се состои од wizard со три чекори: лични податоци и геолокација, преференци и безбедносни информации, потврда. Формата користи `FormData` за да прикачи слика и поле `location` во формат `lat, lng`. Серверот ја валидира телефонската бројка да започнува со +389. [Слика 6.1 – Преглед на чекор 1 од wizard-от]

6.2 Алгоритам за совпаѓања и геофилтрирање
`LikeController::getSwipedUsers` гради листа на корисници што не се лајкани или дизлајкани, применува филтер според `preference` (освен ако е „Се") и користи Haversine формула за растојание. `likeUser` регистрира акција и при реципрочен like креира запис во `matches` и `chats`, па диспечира job за кафе и нотификации. 

[Слика 6.2 – Sequence дијаграм: Swipe → Like запис → Проверка за reciprocity → Match + Chat креирање → Job dispatch → Notification broadcast]

6.3 Чат и размена на датотеки
`MessageController` валидира дека постои текст или фајл, прикачува фајл во `storage/app/public/messages`, а во базата чува дали е фајл и оригинално име. React компонентата `Chat.jsx` ги форматира записите во тип `text`, `photo`, `file` или `system`, прикажува превју и овозможува lightbox. WebSocket каналите автоматски додаваат нова порака во списокот без рефреш. [Слика 6.3 – Екран од chat со преглед на приложена слика]

6.4 Реално-времени известувања и job-ови
`MatchFound` и `NewChatMessage` емитуваат JSON payload што React го обработува за да прикаже модален дијалог (`MatchDialog`) или да обнови табот со пораки. Job-от `FindCafeForMatch` се извршува во опашка, калкулира средишна точка врз основа на геокоординати и создава системска порака со линк до Google Maps. JSON резултатите се зачувуваат во `storage/overpass_responses` за анализа. 

[Слика 6.4 – Sequence дијаграм: Match креирање → Job dispatch → Overpass API повик → Средна точка пресметка → Кафич пронаоѓање → Системска порака → WebSocket broadcast → Echo примање на frontend]

6.5 Административен интерфејс и профил
`Users.jsx` обезбедува CRUD табела за администратори, додека `UserDetails.jsx` овозможува на корисникот да уредува податоци, да прикачува повеќе галерии и да гледа обратен геокодинг на адресата. Модалот за слики дозволува додавање и бришење на preview-слики пред зачувување. [Слика 6.5 – Екран за уредување профил со мапа]

6.6 Тестирање и валидација
- **Unit & Feature тестови (PHPUnit)** – бизнис логиката за взаемно лајкање, Haversine филтрирањето и job-от `FindCafeForMatch` се покриени со feature тестови што користат in-memory база (`php artisan test --parallel`). Тестовите проверуваат дека при реципрочен like се креираат `Matches`, `Chat` и се диспечира job.
- **API & интеграциони тестови** – Postman колекција автоматизира login/signup проток, CRUD над `/users` и испраќање пораки; во CI се извршува со тест база (`sqlite::memory`). Ова потврдува дека middleware-от `auth:sanctum` и валидациите враќаат соодветни статус кодови.
- **Frontend smoke тестови** – Jest + React Testing Library покриваат рендерирање на `SwipeCards` и `MatchDialog` (snapshot + basic interaction). За останатите екрани се користи manual exploratory testing (Chrome devtools device emulation).
- **End-to-end сценарија** – Cypress scripts (work-in-progress) автоматизираат патрамбата „Регистрација → Swipe → Match → Chat“ на локален стек (`php artisan serve` + `npm run dev`). Во моментот се користат и чеклисти за рачно тестирање на мобилен (Chrome/Android) за да се провери responsive layout.
- **Употребливост и пристапност** – токму пред секое големо издание се прават рачни проверкси за македонски copy, контраст и keyboard navigation. Lighthouse се користи за да се следи performance + accessibility score, а идно се планира formal A/B тестирање и moderated user sessions.

6.7 Обработка на грешки и логирање
6.7.1 Backend (Laravel)
Laravel Exception Handler (`app/Exceptions/Handler.php`) ги фаќа сите нефатени exceptions и ги пренасочува кон соодветни HTTP одговори. Во контролерите се користат try-catch блокови за критични операции: `AuthController::signup` фаќа `\Exception`, логира преку `Log::error()` и враќа 500 статус со општа порака „Internal Server Error" за да не се изложат детали на клиентот. Валидационите Request класи (`SignupRequest`, `LoginRequest`) автоматски враќаат 422 со структуриран `errors` објект кога полето не поминува правилата. За автентикација, `auth:sanctum` middleware враќа 401 ако токенот е невалиден или истечен. `MessageController` и `LikeController` проверуваат авторизација и враќаат 403 за неовластен пристап (на пример, ако корисникот се обидува да пристапи до чат каде не е учесник). `findOrFail()` методите на Eloquent автоматски фрлаат `ModelNotFoundException` што Laravel го конвертира во 404. Job-от `FindCafeForMatch` користи try-catch со retry логика за Overpass API повиците (до 3 обиди со 2 секунди пауза) и `Log::info()`/`Log::error()` за да се следи текот и да се идентификуваат проблеми. Сите грешки се логираат во `storage/logs/laravel.log` со контекст (user ID, request data) за лесно debugging.

6.7.2 Frontend (React)
Axios response interceptor (`react/src/axios-client.js`) ги фаќа HTTP грешките глобално: при 401 (unauthorized) се брише токенот од localStorage и се подготвува редирект на login (моментално е коментирано `window.location.reload()`), а при 404 се може да се прикаже not found порака. Секој компонент користи локален `error` state и `catch()` блокови во async функциите: `Login.jsx` и `UserForm.jsx` прикажуваат валидациони грешки (422) под соодветните полиња преку `errors` објект, додека `SwipeCards.jsx` користи `console.error()` за да се логгираат проблеми при fetch на корисници. Loading states (`isLoading`, `loading`) се користат за да се индицира дека операцијата е во тек и за да се спречи дуплирање на барањата. За критични операции како signup, грешките се прикажуваат како toast нотификации преку `ContextProvider` (`setNotification`), а за не-критични операции (како swipe) грешките се само логгираат во конзола за да не се наруши корисничкото искуство. WebSocket грешките (Echo connection failures) се фаќаат во `DefaultLayout.jsx` каде се логираат во конзола, но не се прикажуваат директно на корисникот освен ако не се критични (на пример, не може да се приклучи на каналот).


7. Кориснички сценарија (Use Cases)
7.1 Сценарио „Ново запознавање"
1. Мила ја посетува страницата, ја започнува регистрацијата, ја означува својата населба на мапа и внесува род/преференца.
2. По потврда и автоматско најавување, тоа оди на `/cards`, поставува растојание на 20 km и почнува да свјапува.
3. При двоен like со Петар се појавува `MatchDialog` со нивните профилни слики.
4. Автоматски се отвора чат со системска порака „Овој кафич е идеален..." со линк до кафуле во центарот.
5. Мила испраќа фотографија од омилен колач, Петар добива WebSocket нотификација и одговара.
6. Договорот за средба се конкретизира и корисниците го оценуваат искуството.

[Слика 7.1 – User journey дијаграм: Landing → Signup → Swipe → Match → Chat → Среќа, со визуелни индикатори за секој чекор]

Дополнителни сценарија:
• „Модерирање на профил“ – администратор прегледува нов корисник и го блокира ако нема валидна слика.
• „Враќање во апликација“ – корисник се логира, ги гледа сите нови нотификации и продолжува разговори.


8. Дискусија и можности за подобрување
Силни страни: локализиран UX, интегриран real-time канал, автоматски кафич предлози и богата уредничка конзола. Ограничувања: Haversine пресметките се синхрони и со растечка база треба кеширање; медиумските датотеки моментално се локални – за продукција е препорачливо S3 или Azure Blob. Идни подобрувања: ML модели за препораки базирани на интереси, календар за термин, верификација преку документ или селфи, A/B тестови на UI и мобилна PWA верзија. Дополнително, миграција од Leaflet кон Google Maps API би овозможила прикажување на фотографии на најблиските кафичи директно во системската порака, бидејќи Google Places API нуди пристап до слики на локациите, што би го подобрило визуелното искуство при предлог на кафич.


10. Заклучок
„АјНаКафе“ демонстрира како можат да се спојат Laravel 9, React 18, Sanctum, WebSockets и трети сервиси за да се креира локализирана платформа за запознавање. Системот ги исполнува целите: богата регистрација, интелигентно совпаѓање, сигурен чат и реално-времени нотификации. Архитектонскиот пристап со јасни доменски модели и REST слоевитост ја олеснува идната еволуција: миграција кон микросервиси, мобилни клиенти, повеќе јазици и интеграција со резервациски системи за кафетерии. Проектот потврдува дека квалитетно искуство може да се постигне во веб средина ако се користат современи JavaScript и PHP алатки во комбинација со внимателен UX.


11. Користена литература
[1] Laravel Documentation: Authentication, Notifications и Broadcasting, https://laravel.com/docs/9.x/
[2] React 18 Documentation & Hooks API Reference, https://react.dev/
[3] BeyondCode Laravel WebSockets – Official Docs, https://beyondco.de/docs/laravel-websockets
[4] OpenStreetMap & Overpass API Guide, https://wiki.openstreetmap.org/wiki/Overpass_API
[5] Material UI Design Guidelines, https://mui.com/material-ui/getting-started/overview/
[6] Manhattan Merlot, "My Experience with Tinder Gold: The Golden Wall,https://medium.com/@ManhattanMerlot/tinder-facts-the-hot-matches-are-behind-the-paywall-2580d785ff50

